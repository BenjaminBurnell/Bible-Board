<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Bible Board</title>
    <style>
      #access-denied-blocker {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--bg);
        color: var(--fg);
        z-index: 20000;
        display: none;
        /* Hidden by default */
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 20px;
      }

      #access-denied-blocker h2 {
        font-size: 1.5rem;
        color: #e55353;
      }

      #access-denied-blocker p {
        font-size: 1.1rem;
        color: var(--muted);
        max-width: 400px;
      }

      /* Re-using dash-btn styles from boards.css (loaded via style.css) */
      .back-btn {
        font-family: inherit;
        font-size: 1rem;
        font-weight: 700;
        padding: 10px 16px;
        border-radius: 10px;
        border: 1px solid var(--border);
        background: var(--bg-alt);
        color: var(--fg);
        cursor: pointer;
        text-decoration: none;
        margin-top: 20px;
      }

      #back-to-boards-btn {
        background: none;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 6px;
        border-radius: 15px;
        width: 52px;
        height: 52px;
        transition: 0.3s ease, transform 0.3s ease;
        backdrop-filter: blur(1rem);
        background: var(--bg-seethroug);
        border: 1px solid var(--fg-seethrough);
        color: var(--fg);
        cursor: pointer;
        position: absolute;
        top: 25px;
        left: 25px;
      }
    </style>
  </head>

  <body>
    <div id="access-denied-blocker">
      <h2>Access Denied</h2>
      <p>You do not have permission to view or edit this board.</p>
      <a href="/index.html" class="back-btn">Back to My Boards</a>
    </div>

    <div id="main-content-container">
      <div class="viewport">
        <div id="workspace" class="workspace">
          <svg id="connections" class="connections"></svg>
        </div>
      </div>

      <button id="theme-toggle" class="toggle-btn" aria-label="Toggle Theme">
        <svg
          id="moon-icon"
          xmlns="http://www.w3.org/2000/svg"
          width="22"
          height="22"
          viewBox="0 0 24 24"
          fill="var(--fg)"
        >
          <path d="M21 12.79A9 9 0 0 1 11.21 3 7 7 0 1 0 21 12.79Z" />
        </svg>
        <svg
          id="sun-icon"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 -960 960 960"
          fill="var(--fg)"
        >
          <path
            d="M440-760v-160h80v160h-80Zm266 110-55-55 112-115 56 57-113 113Zm54 210v-80h160v80H760ZM440-40v-160h80v160h-80ZM254-652 140-763l57-56 113 113-56 54Zm508 512L651-255l54-54 114 110-57 59ZM40-440v-80h160v80H40Zm157 300-56-57 112-112 29 27 29 28-114 114Zm283-100q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm0-80q66 0 113-47t47-113q0-66-47-113t-113-47q-66 0-113 47t-47 113q0 66 47 113t113 47Zm0-160Z"
          />
        </svg>
      </button>

      <div
        id="auth-controls"
        style="
          position: absolute;
          top: 25px;
          right: 85px;
          display: flex;
          gap: 8px;
          z-index: 10003;
          align-items: center;
        "
      ></div>
      <div
        id="persistence-status"
        style="
          display: none;
          font-size: 12px;
          font-weight: 700;
          color: var(--muted);
          padding: 5px 10px;
          background: var(--bg-seethroug);
          border-radius: 10px;
          -webkit-backdrop-filter: blur(1rem);
          backdrop-filter: blur(1rem);
          border: 1px solid var(--fg-seethrough);
          transition: all 0.3s ease;
          white-space: nowrap;
          opacity: 0;
          position: fixed;
          top: 25px;
          left: 50%;
          transform: translate(-50%);
        "
      >
        Saving...
      </div>
      <button
        id="bb-tour-help-btn"
        style="
          display: none;
          font-size: 12.5px;
          font-weight: 700;
          color: var(--muted);
          padding: 5px 15px;
          background: var(--bg-seethroug);
          border-radius: 10px;
          border: 1px solid var(--fg-seethrough);
          -webkit-backdrop-filter: blur(1rem);
          backdrop-filter: blur(1rem);
          cursor: pointer;
          height: 50px;
          margin-right: 8px;
          position: absolute;
          top: 25px;
          right: 75px;
        "
      >
        Show Tour
      </button>

      <form id="search-container" onsubmit="return searchForQuery(event)">
        <input
          id="search-bar"
          type="text"
          placeholder="Search"
          autocomplete="off"
        />
        <button id="search-button" type="submit">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
            fill="var(--bg-alt)"
          >
            <path
              d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"
            />
          </svg>
        </button>
      </form>

      <div id="bible-whiteboard-title">
        <div id="bible-whiteboard-text">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
            id="edit-Icon"
            fill="var(--fg)"
          >
            <path
              d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"
            />
          </svg>
          <input
            id="title-textbox"
            type="text"
            placeholder="Untitled Bible Board"
          />
        </div>
      </div>

      <div id="action-buttons-container" title="Actions">
        <button
          id="mobile-action-button"
          class="action-button"
          aria-label="Connect"
          disabled
        >
          <svg
            class="action-icon"
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
          >
            <path
              d="M200-120q-17 0-28.5-11.5T160-160v-40h-40v-160
                q0-17 11.5-28.5T160-400h40v-280q0-66 47-113t113-47
                q66 0 113 47t47 113v400q0 33 23.5 56.5T600-200
                q33 0 56.5-23.5T680-280v-280h-40q-17 0-28.5-11.5
                T600-600v-160h40v-40q0-17 11.5-28.5T680-840h80
                q17 0 28.5 11.5T800-800v40h40v160q0 17-11.5
                28.5T800-560h-40v280q0 66-47 113t-113 47
                q-66 0-113-47t-47-113v-400q0-33-23.5
                -56.5T360-760q-33 0-56.5 23.5T280-680v280h40
                q17 0 28.5 11.5T360-360v160h-40v40q0
                17-11.5 28.5T280-120h-80Z"
            />
          </svg>
        </button>

        <button
          id="text-action-button"
          class="action-button"
          aria-label="Add text"
        >
          <svg
            class="action-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 -960 960 960"
          >
            <path
              d="M160-120v-80h240v-560H240v-80h480v80H560v560h240v80H160Z"
            />
          </svg>
        </button>

        <button
          id="interlinear-action-button"
          class="action-button"
          aria-label="Interlinear (original ↔ English)"
          disabled
        >
          <svg
            class="action-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 -960 960 960"
          >
            <path
              d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h560q33 0 56.5 23.5T800-720v480q0 33-23.5 56.5T720-160H160Zm0-80h560v-480H160v480Zm120-120h200v-80H280v80Zm0-160h360v-80H280v80Z"
            />
          </svg>
        </button>

        <button
          id="delete-action-button"
          class="action-button"
          aria-label="Delete selected"
          disabled
        >
          <svg
            class="action-icon"
            xmlns="http://www.w3.org/2000/svg"
            height="24"
            width="24"
            viewBox="0 -960 960 960"
          >
            <path
              d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360Z"
            />
          </svg>
        </button>
      </div>
    </div>

    <div id="search-query-container">
      <div id="search-query-content">
        <div id="search-query">Search for ""</div>
        <div id="did-you-mean-text">Did you mean ""?</div>

        <div id="search-query-full-container">
          <div id="search-query-verses-text">Verses</div>
          <div id="search-query-verse-container"></div>

          <div id="search-query-songs-text">Songs</div>
          <div id="search-query-song-container" aria-live="polite"></div>
        </div>

        <div id="loader">
          <div class="loader-spinner"></div>
        </div>
      </div>
    </div>

    <aside id="interlinear-panel" aria-live="polite" aria-busy="false">
      <div id="interlinear-header">
        <div id="interlinear-title">Interlinear</div>
        <button id="interlinear-close" aria-label="Close interlinear">
          &times;
        </button>
      </div>

      <div id="interlinear-subtitle"></div>
      <div id="interlinear-list"></div>
      <div id="interlinear-loader" class="panel-loader">
        <div class="loader-spinner"></div>
      </div>
      <div id="interlinear-empty" class="panel-empty">
        Select a verse and press the Interlinear button.
      </div>
      <div id="interlinear-error" class="panel-error">
        Couldn’t load interlinear data.
      </div>
    </aside>

    <button id="back-to-boards-btn" onclick="goBackToBoards()">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        fill="var(--fg)"
      >
        <path
          d="m313-440 224 224-57 56-320-320 320-320 57 56-224 224h487v80H313Z"
        />
      </svg>
    </button>

    <!-- <div id="bible-board-phone-message">
      <div id="bible-board-text">
        Bible board works best on desktop or tablets.
      </div>
    </div> -->

    <script src="search.js"></script>
    <script src="script.js"></script>
    <script src="persist-helper.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <script type="module" src="../supabaseClient.js"></script>

    <link rel="stylesheet" href="tour.css" />
    <script src="tour.js"></script>
    <script type="module" src="../supabase-sync.js"></script>
    <script>
      function goBackToBoards() {
        window.location.href = "../";
      }
    </script>
  </body>
</html>
